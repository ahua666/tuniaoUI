(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["templatePage-animate-bubble-bubble"],{4026:function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("b64b"),n("d3b7"),n("159b");var i=a(n("7e6c")),r={name:"TemplateBubble",mixins:[i.default],data:function(){return{windowHeight:0,windowWidth:0,actionTimer:null,animationTimer:null,queue:{},ctx:null}},onLoad:function(){this.getSystemInfo()},onReady:function(){var t=this;this.$nextTick((function(){t.queue={},t.ctx=uni.createCanvasContext("bubble",t),setTimeout((function(){t.actionTimer=setInterval((function(){t.generateBubble()}),500)}),1e3)}))},onUnload:function(){this.clearActionTimer(),this.clearAnimationTimer()},methods:{getSystemInfo:function(){var t=this,e=uni.getSystemInfoSync();e?(this.windowHeight=e.safeArea.height,this.windowWidth=e.safeArea.width):setTimeout((function(){t.getSystemInfo()}),50)},generateBubble:function(){var t=this,e="https://tnuiimage.tnkjapp.com/bubble/"+this.$tn.number.randomInt(1,33)+".png";uni.getImageInfo({src:e,success:function(e){if("getImageInfo:ok"===e.errMsg){var n={id:(new Date).getTime(),timer:0,opacity:0,pathData:t.generatePathData(),image:e.path,factor:{speed:6e-4,t:.1}};Object.keys(t.queue).length>0?t.queue[n.id]=n:(t.queue[n.id]=n,t.bubbleAnimate())}}})},generatePathData:function(){var t=this.windowWidth,e=this.windowHeight,n={x:.72*t,y:e},a={x:this.$tn.number.random(.22*t,.33*t),y:this.$tn.number.random(.5*e,.75*e)},i={x:this.$tn.number.random(0,.88*t),y:this.$tn.number.random(.25*e,.5*e)},r={x:this.$tn.number.random(0,.88*t),y:this.$tn.number.random(0,.125*e)};return[n,a,i,r]},updatePath:function(t,e){var n=t[0],a=t[1],i=t[2],r=t[3],o=e.t,u=3*(a.x-n.x),s=3*(i.x-a.x)-u,c=r.x-n.x-u-s,d=3*(a.y-n.y),l=3*(i.y-a.y)-d,f=r.y-n.y-d-l,b=c*(o*o*o)+s*(o*o)+u*o+n.x,h=f*(o*o*o)+l*(o*o)+d*o+n.y;return{x:b,y:h}},bubbleAnimate:function(){var t=this,e=(this.windowWidth,this.windowHeight);Object.keys(this.queue).forEach((function(n){var a=t.queue[+n],i=t.updatePath(a.pathData,a.factor),r=i.x,o=i.y,u=a.factor.speed;a.factor.t+=u;var s=30;s=(e-o)/1.5,s=Math.min(30,s);var c=a.opacity;c=o/(.3*e),c=Math.min(1,c),t.ctx.globalAlpha=c,t.ctx.drawImage(a.image,r-s/2,o,s,s),a.factor.t>1&&delete t.queue[a.id],o>e&&delete t.queue[a.id]})),this.ctx.draw(),Object.keys(this.queue).length>0?this.animationTimer=setTimeout((function(){t.bubbleAnimate()}),5):(this.clearAnimationTimer()(),this.ctx.draw())},clearActionTimer:function(){this.actionTimer&&clearInterval(this.actionTimer)},clearAnimationTimer:function(){this.animationTimer&&clearTimeout(this.animationTimer)}}};e.default=r},"5b81":function(t,e,n){var a=n("7e04");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("64ceb39f",a,!0,{sourceMap:!1,shadowMode:!1})},"7e04":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 下方引入的为Tuniao UI的集成样式文件，为scss预处理器，其中包含了一些"tn-"开头的自定义变量\r\n * 使用的时候，请将下面的一行复制到您的uniapp项目根目录的uni.scss中即可\r\n * Tuniao UI自定义的css类名和scss变量，均以"tn-"开头，不会造成冲突，请放心使用 \r\n */.tn-custom-nav-bar__back[data-v-6b3c748d]{width:100%;height:100%;position:relative;display:flex;justify-content:space-evenly;align-items:center;box-sizing:border-box;background-color:rgba(0,0,0,.15);border-radius:%?1000?%;border:%?1?% solid hsla(0,0%,100%,.5);color:#fff;font-size:18px}.tn-custom-nav-bar__back .icon[data-v-6b3c748d]{display:block;flex:1;margin:auto;text-align:center}.tn-custom-nav-bar__back[data-v-6b3c748d]:before{content:" ";width:%?1?%;height:110%;position:absolute;top:22.5%;left:0;right:0;margin:auto;-webkit-transform:scale(.5);transform:scale(.5);-webkit-transform-origin:0 0;transform-origin:0 0;pointer-events:none;box-sizing:border-box;opacity:.7;background-color:#fff}.template-bubble[data-v-6b3c748d]{position:relative;background:linear-gradient(-120deg,#9a5ce5,#01beff,#00f5d4,#43e97b);width:100vw;height:100vh}.template-bubble .bubble[data-v-6b3c748d]{position:fixed;left:0;right:0;top:0;bottom:0;width:100%;height:100%;z-index:1024;pointer-events:none}',""]),t.exports=e},"7e6c":function(t,e,n){var a=n("c973").default;n("96cf"),t.exports={data:function(){return{}},onLoad:function(){this.updateCustomBarInfo()},methods:{goBack:function(){var t=getCurrentPages();if(t&&t.length>0){var e=t[0];1!=t.length||e.route&&"pages/index/index"==e.route?uni.navigateBack({delta:1}):uni.reLaunch({url:"/pages/index/index"})}else uni.reLaunch({url:"/pages/index/index"})},updateCustomBarInfo:function(){var t=this;return a(regeneratorRuntime.mark((function e(){var n,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.vuex_custom_bar_height,a=t.vuex_status_bar_height,n){e.next=15;break}return e.prev=3,e.next=6,t.$tn.updateCustomBar();case 6:i=e.sent,n=i.customBarHeight,a=i.statusBarHeight,e.next=15;break;case 11:return e.prev=11,e.t0=e["catch"](3),setTimeout((function(){t.updateCustomBarInfo()}),10),e.abrupt("return");case 15:t.$tn.vuex("vuex_status_bar_height",a),t.$tn.vuex("vuex_custom_bar_height",n);case 17:case"end":return e.stop()}}),e,null,[[3,11]])})))()}}}},"88f6":function(t,e,n){"use strict";var a=n("5b81"),i=n.n(a);i.a},"93d6":function(t,e,n){"use strict";n.r(e);var a=n("4026"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},a829:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var a={tnNavBar:n("5138").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"template-bubble"},[n("tn-nav-bar",{attrs:{fixed:!0,alpha:!0,customBack:!0}},[n("v-uni-view",{staticClass:"tn-custom-nav-bar__back",attrs:{slot:"back"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goBack.apply(void 0,arguments)}},slot:"back"},[n("v-uni-text",{staticClass:"icon tn-icon-left"}),n("v-uni-text",{staticClass:"icon tn-icon-home-capsule-fill"})],1)],1),n("v-uni-canvas",{staticClass:"bubble",style:{width:t.windowWidth+"px",height:t.windowHeight+"px"},attrs:{"canvas-id":"bubble",id:"bubble"}})],1)},r=[]},c973:function(t,e,n){function a(t,e,n,a,i,r,o){try{var u=t[r](o),s=u.value}catch(c){return void n(c)}u.done?e(s):Promise.resolve(s).then(a,i)}n("d3b7"),t.exports=function(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function u(t){a(o,i,r,u,s,"next",t)}function s(t){a(o,i,r,u,s,"throw",t)}u(void 0)}))}},t.exports.__esModule=!0,t.exports["default"]=t.exports},e110:function(t,e,n){"use strict";n.r(e);var a=n("a829"),i=n("93d6");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("88f6");var o=n("f0c5"),u=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"6b3c748d",null,!1,a["a"],void 0);e["default"]=u.exports}}]);